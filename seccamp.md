問１

高校生の時に先輩に強制されてpython + beautifulsoupで一日かけてForbesの記事タイトルをスクレイピングするプログラムを書いたのが契機で、その後プログラミング教材のテスターのような扱いでswiftを使った簡単なアプリを作った。競技プログラミングにも少し手を出し、問題を500問程度解いたところで伸び悩んでやめた。現在は再開し、レーティング800程度。

大学に入るとともに42 Tokyoというエンジニア養成機関に所属したが、コロナウイルスの影響もありドロップアウトした。そこではC言語でprintfを書いた。他のプログラムとは違い、printfは仕様による要求が多くあるので苦労した。流れとしてはトークナイズをしてから型の情報などに基づき処理をするのだが、文字列型は文字列長の先読みができなかったり、0埋めと文字列長の固定の優先順序の指定がなかったりなどで、ごちゃごちゃとしたプログラムを書いた覚えがある。

現在は主にサークルのホームページやwikiなどをhugoやhonkitを使いながら構築しており、あまり直接コーディングはしていない。言語の処理系には興味を持っており、schemeをpythonで書くlispyは写経した。最近興味がある言語はHaskellで、型を抽象化するなどによって型に情報をもたせる点が興味深いと感じている。

問２

オーソドックスだと思うが、gccによるC言語のコンパイラについて書く。検証環境はdebian bullseyeのgcc v10.2.1。

まず、gccはファイルの中身を読んで構文チェックと構文解析をして、マクロのプリプロセスをする。エラーがなければ構文解析をして、対応するアセンブリを出力、それをアセンブルしてリンク可能ファイルを出力し、標準ライブラリなどとリンクして実行可能ファイルを作るのが一連の流れである。

では、動作を検証していこう。使ったプログラムは https://github.com/phnyo/seccamp2022/examine.cにある。五行に渡って文字列を出力するだけのプログラムである。

プリプロセスのみを行ったファイルは、gccのオプション-Eで出力させると読むことができる。catしてリダイレクトしてその中身を読んでみると、typedefによる型定義と、structによる構造体の生成、関数のプロトタイプ宣言がされていて、末尾にexamine.cの中身がある。
目で読む限りこの出力されたファイルは他のヘッダファイルに依存しているわけではなく、内部で完結している。しかし、実際にstdio.hを覗いてみると、内部では他のヘッダファイルに依存している。そこで、プリプロセス時点でgccはヘッダファイルの依存関係を解決していることがわかる。また、もちろんマクロ文はないのでマクロは変数などに解決される。存在しないヘッダファイルを指定しているとエラーを吐くので、ヘッダファイルの名前解決をしていることもわかる。

そこで、プリプロセスの時点ではヘッダファイルの名前解決、マクロの展開、ヘッダファイル内の依存関係の処理をしていることがわかる。

次に、構文解析を可視化してみる。オプションにはあるものの、それを逐一読むのはほぼ不可能に近いので https://github.com/alapha23/Ast-Extracter_gcc を使って図示をした抽象構文木を見てみる。



そこで、プリプロセスの時点では

この通りで

は単純にsyscallを叩いているわけではなく、Procedure Linkage Tableを呼んでいた。

問３

コンパイラを書く際に難しい点

一つは

問４

C言語またはHaskellで書こうと思っている。Haskellを流暢に書けるようになるためにはまだ時間が必要だと思うので、おそらくC言語になると思う。

問５

一つはバイナリ出力の際のあ

例えば、再代入しない変数はconstのようにその中身に置き換えてしまえば、代入可能な変数域にその変数を置く必要はなく、ただの変数の中身のエイリアスとして取り扱うことができる。


もう一つは遅延読み込みで、すべてのプログラムを先読みするわけではなく、都度計算することによって、

さらに、加減算はすべてbit演算に変換し、データの大きさによっては　

問７

もちろん自分が参加したいという気持ちは強く抱いているが、一方で自分が応募できる年代の中で一番上であることも事実である。この年としてはあまりプログラムを書く能力に秀でいるわけでもないので、もし僅差で（評価方式を全く知らないので定量的な書き方をさせていただく、悪しからず）他の応募者と自分が競るようなことがあれば、その応募者を選んでほしいと思う。若い才能に率先してチャンスを与えてほしい。

